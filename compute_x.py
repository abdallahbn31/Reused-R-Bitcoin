#!/usr/bin/env python3
# Copyright (c) 2025 Abdallah
# Licensed under the GNU GPLv3
# Repo: https://github.com/abdallahbn31/reused-r-bitcoin
# compute_x.py
# Compute k, then x = (s1*k - z1) * r^{-1} mod n

# --------------------------
# Given values
# --------------------------
s1 = 111431484914827310314108809136597661506085346855505784425577929088113412063838
s2 = 82103215168631327946455936234377737221280608082064931975396899914217832303259
z1 = 70121596733354710270739379126478863332897631323035990573894949033544740983882
z2 = 42691526897907875236967398205101700537962275948723679969547592971981809076177
r  = 91699739317935258627372771550459504326006289891191381848862551863464593478869

n = 115792089237316195423570985008687907852837564279074904382605163141518161494337

# --------------------------
# k compute
# --------------------------
s_diff = (s1 - s2) % n
z_diff = (z1 - z2) % n

inv_sdiff = pow(s_diff, -1, n)
k = (z_diff * inv_sdiff) % n

# --------------------------
# x compute
# --------------------------
inv_r = pow(r, -1, n)
x = ( (s1 * k - z1) * inv_r ) % n

# --------------------------
# Show results
# --------------------------
print("s_diff =", s_diff)
print("z_diff =", z_diff)
print("k (decimal) =", k)
print("k (hex)     =", hex(k))
print("x (decimal) =", x)
print("x (hex)     =", hex(x))

# Quick check
ok = ((s1 * k - z1) - x * r) % n == 0
print("verification ok:", ok)